import React, { useEffect, useState } from "react";
import "./MyOrders.css";
import { useDispatch, useSelector } from "react-redux";
import {
  getUserOrders,
  invoiceClicked,
  ticketClicked,
} from "../../redux/actions/userAction";
import InvoiceModal from "./InvoiceModal/InvoiceModal";
import { formatDateFull } from "../../utils/formatDateFull";
import axios from "axios";
import MetaData from "../../landingPage/components/MetaData/MetaData";
import logo from "../../media/org/Dino-Logo.webp";
import user from "../../media/org/user.jpg";

export default function MyOrders() {
  const dispatch = useDispatch();
  const { userOrders } = useSelector((state) => state.orders);
  const { isAdmin } = useSelector((state) => state.user);

  const [invoiceModal, setInvoiceModal] = useState(false);
  const [showQrCode, setShowQrCode] = useState(false);

  const handleInvoiceModalShow = () => {
    setInvoiceModal(true);
  };

  const handleInvoiceModalClose = () => {
    setInvoiceModal(false);
    setShowQrCode(false);
  };
  const handleQrModalShow = () => {
    setInvoiceModal(true);
    setShowQrCode(true);
  };

  useEffect(() => {
    dispatch(getUserOrders());
    // eslint-disable-next-line
  }, []);

  const exportAllTickets = async (id) => {
    try {
      const response = await axios.get(
        `${process.env.REACT_APP_API_URL}orders/download-all-tickets/${id}`,
        {
          responseType: "arraybuffer",
          ContentType: "application/zip",
        }
      );
      const blob = new Blob([response.data], { type: "application/zip" });
      const downloadLink = document.createElement("a");
      downloadLink.href = window.URL.createObjectURL(blob);
      downloadLink.download = "Eintrittskarten.zip";
      document.body.appendChild(downloadLink);
      downloadLink.click();
      document.body.removeChild(downloadLink);
    } catch (error) {
      console.error("Error fetching data:", error);
    }
  };

  const exportSingleTicket = async (orderId, TicketId) => {
    try {
      const response = await axios.get(
        `${process.env.REACT_APP_API_URL}orders/download-ticket/${orderId}/${TicketId}`,
        {
          responseType: "arraybuffer",
          ContentType: "application/pdf",
        }
      );
      const blob = new Blob([response.data], { type: "application/pdf" });
      const downloadLink = document.createElement("a");
      downloadLink.href = window.URL.createObjectURL(blob);
      downloadLink.download = "Eintrittskarten.pdf";

      
      document.body.appendChild(downloadLink);
      downloadLink.click();

      
      document.body.removeChild(downloadLink);
    } catch (error) {
      console.error("Error fetching data:", error);
    }
  };

  return (
    <div className="my-order-container">
      <MetaData title="eTicket - Meine Bestellungen" />
      <div className="_header">
        <h2 className="_title">Meine Bestellungen ({userOrders?.length})</h2>
        <div className="_divider"></div>
      </div>
      {userOrders.length === 0 ? (
        <p>Sie haben keine Bestellungen</p>
      ) : (
        <div className="inner-box">
          {userOrders?.map((order, i) => (
            <>
              <div className="my-order-innerbox" key={i}>
                <div className="event-profile pb-3">
                  <div className="event-logo">
                    {isAdmin ? (
                      <img src={logo} alt="user" />
                    ) : (
                      <img src={user} alt="user" />
                    )}
                  </div>
                  <div className="event-info">
                    <p>{order?.event?.eventName}</p>
                    <div className="event-date align-items-center d-flex gap-2">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          fillRule="evenodd"
                          clipRule="evenodd"
                          d="M8 1C8.55229 1 9 1.44772 9 2V3H15V2C15 1.44772 15.4477 1 16 1C16.5523 1 17 1.44772 17 2V3.00003C17.4591 3.00031 17.8592 3.00313 18.1949 3.03057C18.5902 3.06289 18.9831 3.13424 19.3614 3.32698C19.9248 3.61405 20.3851 4.07224 20.6732 4.63781C20.8659 5.016 20.9372 5.40906 20.9695 5.80396C21 6.17815 21 6.6323 21 7.15839V16.8421C21 17.3682 21 17.8221 20.9695 18.1962C20.9372 18.591 20.8659 18.9838 20.6732 19.3619C20.3854 19.9269 19.9254 20.3859 19.3614 20.6732C18.9833 20.8659 18.5905 20.9372 18.1957 20.9695C17.8217 21 17.3677 21 16.8416 21H7.15839C6.6323 21 6.17815 21 5.80397 20.9695C5.40906 20.9372 5.016 20.8659 4.63781 20.6732C4.07276 20.3853 3.61431 19.9258 3.32698 19.3619C3.13421 18.9835 3.06288 18.5904 3.03057 18.1951C2.99997 17.8206 2.99998 17.3659 3 16.8388V7.16168C2.99998 6.6345 2.99997 6.17965 3.03057 5.80498C3.06286 5.40962 3.13416 5.01624 3.32698 4.63781C3.6146 4.07332 4.07332 3.6146 4.63781 3.32698C5.01625 3.13416 5.40962 3.06286 5.80499 3.03057C6.14079 3.00314 6.54102 3.00031 7 3.00003V2C7 1.44772 7.44772 1 8 1ZM5.9678 5.02393C5.69595 5.04613 5.59517 5.08383 5.54579 5.10899C5.35763 5.20487 5.20487 5.35763 5.109 5.54579C5.08383 5.59517 5.04614 5.69595 5.02393 5.9678C5.00358 6.21702 5.00052 6.53498 5.00007 7H18.9999C18.9995 6.53429 18.9965 6.21614 18.9761 5.96686C18.9539 5.69554 18.9163 5.595 18.8912 5.54579C18.7959 5.35871 18.6427 5.20542 18.4534 5.10899C18.4039 5.08374 18.3032 5.0461 18.0319 5.02392C17.7488 5.00078 17.3768 5 16.8002 5H7.2002C6.62365 5 6.25126 5.00078 5.9678 5.02393ZM19 9H5V16.8002C5 17.3768 5.00078 17.7489 5.02393 18.0322C5.04612 18.3037 5.08378 18.4044 5.109 18.4539C5.20516 18.6426 5.35819 18.7956 5.54579 18.8912C5.595 18.9163 5.69554 18.9539 5.96686 18.9761C6.2498 18.9992 6.62146 19 7.19691 19H16.8031C17.3786 19 17.75 18.9992 18.0327 18.9761C18.3036 18.9539 18.4041 18.9164 18.4534 18.8912C18.6421 18.7951 18.7956 18.6415 18.8912 18.4539C18.9164 18.4046 18.954 18.3041 18.9761 18.0332C18.9992 17.7505 19 17.379 19 16.8036V9ZM7 12C7 11.4477 7.44772 11 8 11H8.002C8.27127 11 8.52916 11.1086 8.71732 11.3012C8.90548 11.4938 9.00802 11.7542 9.00173 12.0234L9.00168 12.0254C8.99548 12.2906 8.88414 12.5425 8.69215 12.7256C8.50016 12.9087 8.24327 13.0081 7.97804 13.0017H7.97608C7.43327 12.9887 7 12.5449 7 12.002V12ZM11 12C11 11.4477 11.4477 11 12 11H12.002C12.2713 11 12.5292 11.1086 12.7173 11.3012C12.9055 11.4938 13.008 11.7542 13.0017 12.0234V12.0254C12.9955 12.2906 12.8841 12.5425 12.6921 12.7256C12.5002 12.9087 12.2433 13.0081 11.978 13.0017H11.9761C11.4333 12.9887 11 12.5449 11 12.002V12ZM15 12C15 11.4477 15.4477 11 16 11H16.002C16.5542 11 17.002 11.4477 17.002 12V12.002C17.002 12.2714 16.8933 12.5293 16.7006 12.7175C16.5078 12.9057 16.2473 13.0082 15.978 13.0017H15.9761C15.4333 12.9887 15 12.5449 15 12.002V12ZM7 16C7 15.4477 7.44772 15 8 15H8.002C8.27127 15 8.52916 15.1086 8.71732 15.3012C8.90548 15.4938 9.00802 15.7542 9.00173 16.0234L9.00168 16.0254C8.99548 16.2906 8.88414 16.5425 8.69215 16.7256C8.50016 16.9087 8.24327 17.0081 7.97804 17.0017H7.97608C7.43327 16.9887 7 16.5449 7 16.002V16ZM11 16C11 15.4477 11.4477 15 12 15H12.002C12.2713 15 12.5292 15.1086 12.7173 15.3012C12.9055 15.4938 13.008 15.7542 13.0017 16.0234V16.0254C12.9955 16.2906 12.8841 16.5425 12.6921 16.7256C12.5002 16.9087 12.2433 17.0081 11.978 17.0017H11.9761C11.4333 16.9887 11 16.5449 11 16.002V16ZM15 16C15 15.4477 15.4477 15 16 15H16.002C16.2713 15 16.5292 15.1086 16.7173 15.3012C16.9055 15.4938 17.008 15.7542 17.0017 16.0234V16.0254C16.9955 16.2906 16.8841 16.5425 16.6921 16.7256C16.5002 16.9087 16.2433 17.0081 15.978 17.0017H15.9761C15.4333 16.9887 15 16.5449 15 16.002V16Z"
                          fill="#444790"
                        />
                      </svg>
                      <span>{formatDateFull(order.event.startDate)}</span>
                    </div>
                  </div>
                </div>
                <div className="my-order-invoice mb-4">
                  <div className="invoice-name-icon d-flex align-items-center gap-2">
                    <div className="ino-icon">
                      <svg
                        width="20"
                        height="21"
                        viewBox="0 0 20 21"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <g clipPath="url(#clip0_511_5287)">
                          <path
                            d="M17.6555 4.61762L13.4358 0.186974C13.3202 0.0655289 13.1644 0 13.0054 0H6.89835C6.5625 0 6.28983 0.286308 6.28983 0.638947V4.3076H2.79602C2.46017 4.3076 2.1875 4.59375 2.1875 4.94655V20.3611C2.1875 20.7137 2.46017 21 2.79602 21H13.1226C13.4586 21 13.7312 20.7137 13.7312 20.3611V16.6924H17.225C17.5609 16.6924 17.8336 16.4062 17.8336 16.0535V5.0696C17.8336 4.90714 17.774 4.74211 17.6555 4.61762ZM16.6165 15.4145H13.7312V9.3772C13.7312 9.21169 13.6699 9.04779 13.553 8.92506L9.3335 4.49458C9.2189 4.37409 9.06342 4.30744 8.90305 4.30744H7.50702V1.27789H12.3969V5.0696C12.3969 5.42223 12.6695 5.70854 13.0054 5.70854H16.6165V15.4145ZM12.514 19.7221H3.40454V5.58549H8.29437V9.3772C8.29437 9.72984 8.56705 10.0161 8.90305 10.0161H12.514V19.7221ZM9.51157 6.48896L11.6536 8.73809H9.51157V6.48896ZM15.7559 4.43065H13.6139V2.18152C13.8817 2.46254 15.5423 4.20634 15.7559 4.43065Z"
                            fill="#444790"
                          />
                        </g>
                        <defs>
                          <clipPath id="clip0_511_5287">
                            <rect width="20" height="21" fill="white" />
                          </clipPath>
                        </defs>
                      </svg>
                    </div>
                    <p>{order?.code}</p>
                  </div>
                  <div className="invoice-price">
                    <p>
                      {order?.paymentDetails?.totalAmount
                        .toFixed(2)
                        .replace(".", ",")}{" "}
                      €
                    </p>
                  </div>
                  <div className="invoice-icons d-flex gap-2">
                    <button
                      className="btn_orders"
                      onClick={() => exportAllTickets(order._id)}
                    >
                      <svg
                        width="16"
                        height="16"
                        viewBox="0 0 16 16"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M5.80004 5.13343L7.33337 3.6001V10.0001C7.33337 10.4001 7.60004 10.6668 8.00004 10.6668C8.40004 10.6668 8.66671 10.4001 8.66671 10.0001V3.6001L10.2 5.13343C10.4667 5.4001 10.8667 5.4001 11.1334 5.13343C11.4 4.86676 11.4 4.46676 11.1334 4.2001L8.46671 1.53343C8.40004 1.46676 8.33337 1.4001 8.26671 1.4001C8.13337 1.33343 7.93337 1.33343 7.73337 1.4001C7.66671 1.4001 7.60004 1.46676 7.53337 1.53343L4.86671 4.2001C4.60004 4.46676 4.60004 4.86676 4.86671 5.13343C5.13337 5.4001 5.53337 5.4001 5.80004 5.13343ZM14 9.33343C13.6 9.33343 13.3334 9.6001 13.3334 10.0001V12.6668C13.3334 13.0668 13.0667 13.3334 12.6667 13.3334H3.33337C2.93337 13.3334 2.66671 13.0668 2.66671 12.6668V10.0001C2.66671 9.6001 2.40004 9.33343 2.00004 9.33343C1.60004 9.33343 1.33337 9.6001 1.33337 10.0001V12.6668C1.33337 13.8001 2.20004 14.6668 3.33337 14.6668H12.6667C13.8 14.6668 14.6667 13.8001 14.6667 12.6668V10.0001C14.6667 9.6001 14.4 9.33343 14 9.33343Z"
                          fill="white"
                        />
                      </svg>
                    </button>
                    <button
                      className="btn_orders"
                      onClick={() => {
                        handleInvoiceModalShow();
                        dispatch(invoiceClicked(order));
                      }}
                    >
                      <svg
                        width="16"
                        height="16"
                        viewBox="0 0 16 16"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <g clipPath="url(#clip0_511_5291)">
                          <path
                            d="M8.00003 10.575C9.42068 10.575 10.575 9.42068 10.575 8.00003C10.575 6.57939 9.42068 5.42512 8.00003 5.42512C6.57939 5.42512 5.42512 6.57939 5.42512 8.00003C5.42512 9.42068 6.57939 10.575 8.00003 10.575ZM8.19537 8.76363C8.51502 8.76363 8.78139 8.49726 8.78139 8.17761H9.63377C9.61602 8.97673 8.97673 9.61602 8.19537 9.61602V8.76363Z"
                            fill="white"
                          />
                          <path
                            d="M0.186459 8.53281C1.0566 9.61605 4.16426 13.1499 8 13.1499C11.8357 13.1499 14.9434 9.61605 15.8135 8.53281C16.0622 8.23092 16.0622 7.78697 15.8135 7.46733C14.9434 6.38409 11.8357 2.85023 8 2.85023C4.16426 2.85023 1.0566 6.38409 0.186459 7.46733C-0.0621529 7.76921 -0.0621529 8.21317 0.186459 8.53281ZM8 4.27088C10.0599 4.27088 11.7292 5.94014 11.7292 8.00007C11.7292 10.06 10.0599 11.7293 8 11.7293C5.94007 11.7293 4.27081 10.06 4.27081 8.00007C4.27081 5.94014 5.94007 4.27088 8 4.27088Z"
                            fill="white"
                          />
                        </g>
                        <defs>
                          <clipPath id="clip0_511_5291">
                            <rect
                              width="16"
                              height="16"
                              fill="white"
                              transform="matrix(-1 0 0 -1 16 16)"
                            />
                          </clipPath>
                        </defs>
                      </svg>
                    </button>
                  </div>
                </div>
                <div className="my-order-tickets-container">
                  <div className="_header">
                    <h2 className="_title">Tickets ({order.tickets.length})</h2>
                  </div>
                  <div className="my-order-tickets">
                    {order.tickets.map((ticket, index) => (
                      <div className="my-order-ticket-box" key={index}>
                        <div className="ticket-details">
                          <div className="ticket-inf">
                            <div className="icn">
                              <svg
                                width="30"
                                height="26"
                                viewBox="0 0 30 31"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                              >
                                <path
                                  d="M5.62322 1.05097L3.55697 6.07677C3.51475 6.17082 3.49292 6.27274 3.49292 6.37583C3.49292 6.47892 3.51475 6.58085 3.55697 6.6749C3.6358 6.8647 3.78663 7.01553 3.97644 7.09436L5.4368 7.68472C5.86645 7.86833 6.23098 8.17685 6.48308 8.57024C6.73519 8.96363 6.86321 9.42372 6.85054 9.89079H29.121L6.64081 0.631503C6.54648 0.592027 6.44528 0.571565 6.34302 0.571292C6.24076 0.571019 6.13945 0.59094 6.04491 0.629912C5.95036 0.668884 5.86445 0.72614 5.79208 0.798395C5.71972 0.87065 5.66234 0.956482 5.62322 1.05097Z"
                                  fill="white"
                                />
                                <path
                                  d="M0.776786 30.0874H33.4018C33.6078 30.0874 33.8054 30.0056 33.9511 29.8599C34.0967 29.7142 34.1786 29.5167 34.1786 29.3106V23.8732C34.1786 23.6671 34.0967 23.4696 33.9511 23.3239C33.8054 23.1782 33.6078 23.0964 33.4018 23.0964H31.8482C31.2302 23.0964 30.6374 22.8508 30.2004 22.4138C29.7634 21.9768 29.5179 21.3841 29.5179 20.766C29.5179 20.148 29.7634 19.5552 30.2004 19.1182C30.6374 18.6812 31.2302 18.4357 31.8482 18.4357H33.4018C33.6078 18.4357 33.8054 18.3538 33.9511 18.2081C34.0967 18.0625 34.1786 17.8649 34.1786 17.6589V12.2214C34.1786 12.0153 34.0967 11.8178 33.9511 11.6721C33.8054 11.5264 33.6078 11.4446 33.4018 11.4446H0.776786C0.570769 11.4446 0.373191 11.5264 0.227515 11.6721C0.0818397 11.8178 0 12.0153 0 12.2214V17.6589C0 17.8649 0.0818397 18.0625 0.227515 18.2081C0.373191 18.3538 0.570769 18.4357 0.776786 18.4357H2.33036C2.94841 18.4357 3.54114 18.6812 3.97817 19.1182C4.4152 19.5552 4.66071 20.148 4.66071 20.766C4.66071 21.3841 4.4152 21.9768 3.97817 22.4138C3.54114 22.8508 2.94841 23.0964 2.33036 23.0964H0.776786C0.570769 23.0964 0.373191 23.1782 0.227515 23.3239C0.0818397 23.4696 0 23.6671 0 23.8732V29.3106C0 29.5167 0.0818397 29.7142 0.227515 29.8599C0.373191 30.0056 0.570769 30.0874 0.776786 30.0874ZM23.3036 15.3285C23.3036 15.1225 23.3854 14.9249 23.5311 14.7792C23.6768 14.6336 23.8743 14.5517 24.0804 14.5517C24.2864 14.5517 24.484 14.6336 24.6296 14.7792C24.7753 14.9249 24.8571 15.1225 24.8571 15.3285V16.8821C24.8571 17.0881 24.7753 17.2857 24.6296 17.4314C24.484 17.577 24.2864 17.6589 24.0804 17.6589C23.8743 17.6589 23.6768 17.577 23.5311 17.4314C23.3854 17.2857 23.3036 17.0881 23.3036 16.8821V15.3285ZM23.3036 19.9892C23.3036 19.7832 23.3854 19.5856 23.5311 19.44C23.6768 19.2943 23.8743 19.2124 24.0804 19.2124C24.2864 19.2124 24.484 19.2943 24.6296 19.44C24.7753 19.5856 24.8571 19.7832 24.8571 19.9892V21.5428C24.8571 21.7488 24.7753 21.9464 24.6296 22.0921C24.484 22.2377 24.2864 22.3196 24.0804 22.3196C23.8743 22.3196 23.6768 22.2377 23.5311 22.0921C23.3854 21.9464 23.3036 21.7488 23.3036 21.5428V19.9892ZM23.3036 24.6499C23.3036 24.4439 23.3854 24.2463 23.5311 24.1007C23.6768 23.955 23.8743 23.8732 24.0804 23.8732C24.2864 23.8732 24.484 23.955 24.6296 24.1007C24.7753 24.2463 24.8571 24.4439 24.8571 24.6499V26.2035C24.8571 26.4095 24.7753 26.6071 24.6296 26.7528C24.484 26.8985 24.2864 26.9803 24.0804 26.9803C23.8743 26.9803 23.6768 26.8985 23.5311 26.7528C23.3854 26.6071 23.3036 26.4095 23.3036 26.2035V24.6499ZM10.0982 16.1053H19.4196C19.6257 16.1053 19.8232 16.1871 19.9689 16.3328C20.1146 16.4785 20.1964 16.6761 20.1964 16.8821C20.1964 17.0881 20.1146 17.2857 19.9689 17.4314C19.8232 17.577 19.6257 17.6589 19.4196 17.6589H10.0982C9.8922 17.6589 9.69462 17.577 9.54894 17.4314C9.40327 17.2857 9.32143 17.0881 9.32143 16.8821C9.32143 16.6761 9.40327 16.4785 9.54894 16.3328C9.69462 16.1871 9.8922 16.1053 10.0982 16.1053ZM10.0982 19.9892H19.4196C19.6257 19.9892 19.8232 20.0711 19.9689 20.2167C20.1146 20.3624 20.1964 20.56 20.1964 20.766C20.1964 20.972 20.1146 21.1696 19.9689 21.3153C19.8232 21.461 19.6257 21.5428 19.4196 21.5428H10.0982C9.8922 21.5428 9.69462 21.461 9.54894 21.3153C9.40327 21.1696 9.32143 20.972 9.32143 20.766C9.32143 20.56 9.40327 20.3624 9.54894 20.2167C9.69462 20.0711 9.8922 19.9892 10.0982 19.9892ZM10.0982 23.8732H19.4196C19.6257 23.8732 19.8232 23.955 19.9689 24.1007C20.1146 24.2463 20.1964 24.4439 20.1964 24.6499C20.1964 24.856 20.1146 25.0535 19.9689 25.1992C19.8232 25.3449 19.6257 25.4267 19.4196 25.4267H10.0982C9.8922 25.4267 9.69462 25.3449 9.54894 25.1992C9.40327 25.0535 9.32143 24.856 9.32143 24.6499C9.32143 24.4439 9.40327 24.2463 9.54894 24.1007C9.69462 23.955 9.8922 23.8732 10.0982 23.8732Z"
                                  fill="white"
                                />
                              </svg>
                            </div>
                            <span>{ticket.ticket.name}</span>
                            <p>
                              {ticket.ticket.price.toFixed(1).replace(".", ",")}{" "}
                              €
                            </p>
                          </div>
                          <div className="ticket-icn d-flex flex-column justify-content-between gap-2 ">
                            <svg
                              width="150"
                              height="1"
                              viewBox="0 0 171 1"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg"
                            >
                              <line
                                y1="0.5"
                                x2="171"
                                y2="0.5"
                                stroke="#64C3C5"
                                stroke-dasharray="3 3"
                              />
                            </svg>
                            <div className="d-flex justify-content-center gap-2">
                              <button
                                className="btn_orders"
                                onClick={() =>
                                  exportSingleTicket(
                                    order._id,
                                    ticket.ticket._id
                                  )
                                }
                              >
                                <svg
                                  width="16"
                                  height="16"
                                  viewBox="0 0 16 16"
                                  fill="none"
                                  xmlns="http://www.w3.org/2000/svg"
                                >
                                  <path
                                    d="M5.80004 5.13343L7.33337 3.6001V10.0001C7.33337 10.4001 7.60004 10.6668 8.00004 10.6668C8.40004 10.6668 8.66671 10.4001 8.66671 10.0001V3.6001L10.2 5.13343C10.4667 5.4001 10.8667 5.4001 11.1334 5.13343C11.4 4.86676 11.4 4.46676 11.1334 4.2001L8.46671 1.53343C8.40004 1.46676 8.33337 1.4001 8.26671 1.4001C8.13337 1.33343 7.93337 1.33343 7.73337 1.4001C7.66671 1.4001 7.60004 1.46676 7.53337 1.53343L4.86671 4.2001C4.60004 4.46676 4.60004 4.86676 4.86671 5.13343C5.13337 5.4001 5.53337 5.4001 5.80004 5.13343ZM14 9.33343C13.6 9.33343 13.3334 9.6001 13.3334 10.0001V12.6668C13.3334 13.0668 13.0667 13.3334 12.6667 13.3334H3.33337C2.93337 13.3334 2.66671 13.0668 2.66671 12.6668V10.0001C2.66671 9.6001 2.40004 9.33343 2.00004 9.33343C1.60004 9.33343 1.33337 9.6001 1.33337 10.0001V12.6668C1.33337 13.8001 2.20004 14.6668 3.33337 14.6668H12.6667C13.8 14.6668 14.6667 13.8001 14.6667 12.6668V10.0001C14.6667 9.6001 14.4 9.33343 14 9.33343Z"
                                    fill="white"
                                  />
                                </svg>
                              </button>
                              <button
                                className="btn_orders"
                                onClick={() => {
                                  handleQrModalShow();
                                  dispatch(invoiceClicked(order));
                                  dispatch(ticketClicked(ticket));
                                }}
                              >
                                <svg
                                  width="16"
                                  height="16"
                                  viewBox="0 0 16 16"
                                  fill="none"
                                  xmlns="http://www.w3.org/2000/svg"
                                >
                                  <g clipPath="url(#clip0_511_5291)">
                                    <path
                                      d="M8.00003 10.575C9.42068 10.575 10.575 9.42068 10.575 8.00003C10.575 6.57939 9.42068 5.42512 8.00003 5.42512C6.57939 5.42512 5.42512 6.57939 5.42512 8.00003C5.42512 9.42068 6.57939 10.575 8.00003 10.575ZM8.19537 8.76363C8.51502 8.76363 8.78139 8.49726 8.78139 8.17761H9.63377C9.61602 8.97673 8.97673 9.61602 8.19537 9.61602V8.76363Z"
                                      fill="white"
                                    />
                                    <path
                                      d="M0.186459 8.53281C1.0566 9.61605 4.16426 13.1499 8 13.1499C11.8357 13.1499 14.9434 9.61605 15.8135 8.53281C16.0622 8.23092 16.0622 7.78697 15.8135 7.46733C14.9434 6.38409 11.8357 2.85023 8 2.85023C4.16426 2.85023 1.0566 6.38409 0.186459 7.46733C-0.0621529 7.76921 -0.0621529 8.21317 0.186459 8.53281ZM8 4.27088C10.0599 4.27088 11.7292 5.94014 11.7292 8.00007C11.7292 10.06 10.0599 11.7293 8 11.7293C5.94007 11.7293 4.27081 10.06 4.27081 8.00007C4.27081 5.94014 5.94007 4.27088 8 4.27088Z"
                                      fill="white"
                                    />
                                  </g>
                                  <defs>
                                    <clipPath id="clip0_511_5291">
                                      <rect
                                        width="16"
                                        height="16"
                                        fill="white"
                                        transform="matrix(-1 0 0 -1 16 16)"
                                      />
                                    </clipPath>
                                  </defs>
                                </svg>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </>
          ))}
        </div>
      )}
      <InvoiceModal
        invoiceModal={invoiceModal}
        handleInvoiceModalClose={handleInvoiceModalClose}
        showQrCode={showQrCode}
        setShowQrCode={setShowQrCode}
        exportAllTickets={exportAllTickets}
      />
    </div>
  );
}
